<!DOCTYPE html>
<html>
  <head>
    <link
      rel="shortcut icon"
      href="./assets/images/icon.png"
      type="image/png"
    />
    <title>Infinite</title>

    <link rel="stylesheet" href="./css/master.css" />

    <script src="./js/auth.js"></script>
    <script src="/uv/uv.bundle.js" charset="UTF-8"></script>
    <script src="/uv/uv.config.js"></script>
    <script src="./js/preload.js"></script>

  </head>

  <body>
    <nav>
      <div class="logo">
        <a href="/">
          <img src="./assets/images/icon.png" alt="Logo" draggable="false" />
          <h1>Infinite</h1>
        </a>
      </div>

      <p id="time"></p>

      <div class="navitems">
        <div class="navitem"><a href="/">Home</a></div>
        <div class="navitem"><a href="/gs.html">Games</a></div>
        <div class="navitem"><a href="/apps.html">Apps</a></div>
        <div class="navitem"><a href="/search.html">Web Proxy</a></div>
        <div class="navitem"><a selected href="/settings.html">Settings</a></div>
      </div>
    </nav>

    <div class="center-container">
      <h1>Settings</h1>

      <h2>Tab cloaking</h2>
      <input type="text" id="tabname" placeholder="Tab name" /><br />
      <input type="text" id="tabicon" placeholder="Tab icon" /><br />

      <button class="secondary" onclick="setTabPreset('default')">
        <img src="/assets/images/icon.png" />
      </button>
      <button class="secondary" onclick="setTabPreset('google')">
        <img
          src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3c/Google_Favicon_2025.svg/500px-Google_Favicon_2025.svg.png"
        />
      </button>
      <button class="secondary" onclick="setTabPreset('drive')">
        <img
          src="https://ssl.gstatic.com/docs/doclist/images/drive_2022q3_32dp.png"
        />
      </button>
      <button class="secondary" onclick="setTabPreset('docs')">
        <img
          src="https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico"
        />
      </button>
      <button class="secondary" onclick="setTabPreset('classroom')">
        <img
          src="https://ssl.gstatic.com/classroom/ic_product_classroom_32.png"
        />
      </button>

      <br /><br />

      <h2>Panic Key Setup</h2>

      <!-- Current Configuration Display -->
      <div id="panic-current-config" style="display: none;">
        <div class="current-panic-display">
          <h3>Panic Key Configured</h3>
          <div class="config-info">
            <div class="config-item">
              <strong>Panic Key:</strong> <span id="current-panic-key">Not set</span>
            </div>
            <div class="config-item">
              <strong>Redirect URL:</strong> <span id="current-panic-url">Not set</span>
            </div>
          </div>
          <div class="config-actions">
            <button onclick="reconfigurePanicKey()" class="secondary">Reconfigure</button>
            <button onclick="clearPanicKey()" class="secondary danger">Remove</button>
          </div>
        </div>
      </div>

      <div id="panic-setup-container">
        <!-- Step 1: Introduction -->
        <div id="panic-step-1" class="panic-step">
          <h3>üö® Set up your panic key</h3>
          <p>A panic key instantly redirects to a safe website when pressed. This helps you quickly switch away from this site if needed.</p>
          <div class="panic-tips">
            <h4>üí° Tips for choosing a good panic key:</h4>
            <ul>
              <li>Use a key you don't press often (like F1, F2, or the ` key)</li>
              <li>Avoid common keys like Space, Enter, or letters you type frequently</li>
              <li>The panic key works anywhere on this site, even while typing</li>
            </ul>
          </div>
          <button onclick="goToPanicStep(2)" class="button">Get Started ‚Üí</button>
        </div>

        <!-- Step 2: Choose URL -->
        <div id="panic-step-2" class="panic-step" style="display: none;">
          <h3>Step 1: Choose where to redirect</h3>
          <p>Select a safe website to redirect to when the panic key is pressed:</p>

          <div class="panic-url-grid">
            <button class="panic-url-option" onclick="setPanicUrlAndContinue('google')">
              <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3c/Google_Favicon_2025.svg/500px-Google_Favicon_2025.svg.png" />
              <span>Google</span>
            </button>
            <button class="panic-url-option" onclick="setPanicUrlAndContinue('drive')">
              <img src="https://ssl.gstatic.com/docs/doclist/images/drive_2022q3_32dp.png" />
              <span>Google Drive</span>
            </button>
            <button class="panic-url-option" onclick="setPanicUrlAndContinue('docs')">
              <img src="https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico" />
              <span>Google Docs</span>
            </button>
            <button class="panic-url-option" onclick="setPanicUrlAndContinue('classroom')">
              <img src="https://ssl.gstatic.com/classroom/ic_product_classroom_32.png" />
              <span>Google Classroom</span>
            </button>
          </div>

          <div class="custom-url-section">
            <p>Or enter a custom URL:</p>
            <input type="text" id="panicurl" placeholder="https://example.com" />
            <button onclick="setCustomPanicUrlAndContinue()" class="secondary">Use Custom URL</button>
          </div>

          <button onclick="goToPanicStep(1)" class="secondary">‚Üê Back</button>
        </div>

        <!-- Step 3: Choose Key -->
        <div id="panic-step-3" class="panic-step" style="display: none;">
          <h3>Step 2: Choose your panic key</h3>
          <p>Selected URL: <strong id="selected-panic-url"></strong></p>

          <div class="key-selection-methods">
            <div class="method-card">
              <h4>üñ±Ô∏è Recommended: Auto-detect</h4>
              <p>Click the button below, then press the key you want to use:</p>
              <button onclick="startGuidedDetection()" id="guided-detect-btn" class="button">
                Press to detect key
              </button>
              <div id="detection-status" style="display: none;"></div>
            </div>

            <div class="method-card">
              <h4>‚å®Ô∏è Manual entry</h4>
              <p>Type the key name manually (e.g., "F1", "Escape", "`"):</p>
              <input type="text" id="panickey" placeholder="Enter key name" />
              <button onclick="setManualKeyAndFinish()" class="secondary">Set Key</button>
            </div>
          </div>

          <button onclick="goToPanicStep(2)" class="secondary">‚Üê Back</button>
        </div>

        <!-- Step 4: Success -->
        <div id="panic-step-4" class="panic-step" style="display: none;">
          <h3>‚úÖ Panic key setup complete!</h3>
          <div class="success-summary">
            <p><strong>Panic Key:</strong> <span id="final-key"></span></p>
            <p><strong>Redirect URL:</strong> <span id="final-url"></span></p>
          </div>

          <div class="test-section">
            <h4>üß™ Test your panic key</h4>
            <p>Try pressing your panic key now to make sure it works!</p>
            <button onclick="testPanicKey()" class="button">Test Panic Key</button>
          </div>

          <div class="completion-actions">
            <button onclick="goToPanicStep(1)" class="secondary">Set Up Again</button>
            <button onclick="closePanicSetup()" class="button">Done</button>
          </div>
        </div>

        <!-- Existing/Advanced Settings -->
        <div id="panic-advanced" style="display: none;">
          <h3>Advanced Settings</h3>
          <input type="text" id="panickey-advanced" placeholder="Panic key" />
          <input type="text" id="panicurl-advanced" placeholder="Panic url" />
          <button onclick="detectPanic()" id="panickeybtn" class="secondary">Auto-detect panic key</button>
        </div>
      </div>

      <div id="panic-current-settings" style="margin-top: 20px;">
        <button onclick="toggleAdvancedPanic()" class="secondary" id="advanced-toggle">Show Advanced Settings</button>
      </div>

      <br /><br />

      <h2>Authentication</h2>
      <button onclick="logout()" class="secondary" style="background-color: #e74c3c; color: white;">
        Log Out
      </button>
    </div>
  </body>

  <script src="./js/index.js"></script>
  <script src="./js/settings.js"></script>

</html>
